import{u as k,a as _,r as n,s as E,j as s,L as g,U as S}from"./index-CaI0NtCl.js";import{S as C}from"./SEO-CF4K7_er.js";import{n as L}from"./news-CM9VcU_3.js";import{P as T}from"./plus-8IYyOKOL.js";import{C as D}from"./calendar-DgeWw4ad.js";import{E as P}from"./eye-DddH8_73.js";import{E as R}from"./external-link-BXtpLL6j.js";import{T as U}from"./tag-BB8YpVHw.js";const W=()=>{const{language:a}=k(),{userRole:i}=_(),[o,h]=n.useState([]),[u,f]=n.useState(!0),[l,d]=n.useState("all"),[p,j]=n.useState([]),t=L[a],N=i==="admin"||i==="lead";n.useEffect(()=>{w()},[]);const w=async()=>{try{const{data:e,error:r}=await E.from("news").select("*").eq("published",!0).order("date",{ascending:!1});if(r)throw r;if(e){h(e);const c=[...new Set(e.map(v=>v.category))];j(c)}}catch(e){console.error("Error fetching news:",e)}finally{f(!1)}},x=l==="all"?o:o.filter(e=>e.category===l),m=e=>{switch(a){case"ko":return e.title_ko;case"en":return e.title_en;case"ja":return e.title_ja;default:return e.title_ko}},b=e=>{switch(a){case"ko":return e.excerpt_ko||e.content_ko.substring(0,150)+"...";case"en":return e.excerpt_en||e.content_en.substring(0,150)+"...";case"ja":return e.excerpt_ja||e.content_ja.substring(0,150)+"...";default:return e.excerpt_ko||e.content_ko.substring(0,150)+"..."}},y=e=>new Date(e).toLocaleDateString(a==="ko"?"ko-KR":a==="ja"?"ja-JP":"en-US",{year:"numeric",month:"long",day:"numeric"});return u?s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsx("div",{className:"text-xl",children:t.loading})}):s.jsxs(s.Fragment,{children:[s.jsx(C,{title:t.pageTitle,description:t.pageDescription}),s.jsx("div",{className:"min-h-screen py-20 px-4",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsxs("div",{className:"text-center mb-12",children:[s.jsx("h1",{className:"text-5xl font-bold mb-4",children:t.title}),s.jsx("p",{className:"text-xl text-gray-400",children:t.subtitle})]}),N&&s.jsx("div",{className:"flex justify-end mb-6",children:s.jsxs(g,{to:"/write?type=news",className:"inline-flex items-center px-4 py-2 bg-green-600 hover:bg-green-700 rounded-md text-white transition-colors",children:[s.jsx(T,{className:"h-5 w-5 mr-2"}),t.writeNews]})}),s.jsxs("div",{className:"flex flex-wrap gap-2 mb-8 justify-center",children:[s.jsx("button",{onClick:()=>d("all"),className:`px-4 py-2 rounded-full transition-colors ${l==="all"?"bg-blue-600 text-white":"bg-gray-800 text-gray-300 hover:bg-gray-700"}`,children:t.allCategories}),p.map(e=>s.jsx("button",{onClick:()=>d(e),className:`px-4 py-2 rounded-full transition-colors ${l===e?"bg-blue-600 text-white":"bg-gray-800 text-gray-300 hover:bg-gray-700"}`,children:e},e))]}),x.length===0?s.jsx("div",{className:"text-center py-12",children:s.jsx("p",{className:"text-gray-400",children:t.noNews})}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:x.map(e=>s.jsxs("article",{className:"bg-gray-900 rounded-lg overflow-hidden hover:shadow-xl transition-shadow",children:[e.featured_image&&s.jsx("div",{className:"aspect-video overflow-hidden",children:s.jsx("img",{src:e.featured_image,alt:m(e),className:"w-full h-full object-cover hover:scale-105 transition-transform duration-300"})}),s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3 text-sm text-gray-400",children:[s.jsx("span",{className:"bg-gray-800 px-3 py-1 rounded-full",children:e.category}),s.jsxs("div",{className:"flex items-center",children:[s.jsx(D,{className:"h-4 w-4 mr-1"}),y(e.date)]})]}),s.jsx("h2",{className:"text-xl font-bold mb-3 line-clamp-2",children:s.jsx(g,{to:`/news/${e.slug}`,className:"hover:text-blue-400 transition-colors",children:m(e)})}),s.jsx("p",{className:"text-gray-400 mb-4 line-clamp-3",children:b(e)}),s.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(S,{className:"h-4 w-4 mr-1"}),e.author]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx(P,{className:"h-4 w-4 mr-1"}),e.views]})]}),e.steam_link&&s.jsx("a",{href:e.steam_link,target:"_blank",rel:"noopener noreferrer",className:"flex items-center hover:text-blue-400 transition-colors",children:s.jsx(R,{className:"h-4 w-4"})})]}),e.tags&&e.tags.length>0&&s.jsx("div",{className:"flex flex-wrap gap-1 mt-3",children:e.tags.map((r,c)=>s.jsxs("span",{className:"inline-flex items-center text-xs bg-gray-800 text-gray-400 px-2 py-1 rounded",children:[s.jsx(U,{className:"h-3 w-3 mr-1"}),r]},c))})]})]},e.id))})]})})]})};export{W as default};
