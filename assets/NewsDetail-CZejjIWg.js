import{h as _,b as E,u as L,a as S,r as c,s as d,j as e,L as m,U as q}from"./index-UNarOc67.js";import{S as C}from"./SEO-hFNSaJYv.js";import{M as T}from"./MarkdownViewer-DVEQEVOx.js";import{n as R}from"./news-CM9VcU_3.js";import{C as D}from"./chevron-left-D195hL3i.js";import{P}from"./pen-LqZnre6f.js";import{C as I}from"./calendar-Ra1SVzeA.js";import{E as U}from"./eye-BTw2Lb8X.js";import{T as $}from"./tag-BGjsPmLS.js";const H=()=>{const{slug:i}=_(),x=E(),{language:a}=L(),{user:A,isAdmin:j,userRole:w}=S(),[t,N]=c.useState(null),[p,b]=c.useState(!0),[h,y]=c.useState([]),l=R[a];c.useEffect(()=>{i&&v()},[i]);const v=async()=>{try{const{data:s,error:r}=await d.from("news").select("*").eq("slug",i).eq("published",!0).single();if(r)throw r;s&&(N(s),"views"in s&&await d.from("news").update({views:(s.views||0)+1}).eq("id",s.id),k(s.category,s.id))}catch(s){console.error("Error fetching news:",s),x("/news")}finally{b(!1)}},k=async(s,r)=>{try{const{data:o,error:f}=await d.from("news").select("*").eq("published",!0).eq("category",s).neq("id",r).order("date",{ascending:!1}).limit(3);if(f)throw f;y(o||[])}catch(o){console.error("Error fetching related news:",o)}},n=s=>{switch(a){case"ko":return s.title_ko;case"en":return s.title_en;case"ja":return s.title_ja;default:return s.title_ko}},u=s=>{switch(a){case"ko":return s.content_ko;case"en":return s.content_en;case"ja":return s.content_ja;default:return s.content_ko}},g=s=>new Date(s).toLocaleDateString(a==="ko"?"ko-KR":a==="ja"?"ja-JP":"en-US",{year:"numeric",month:"long",day:"numeric"});return p?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"text-xl",children:l.loading})}):t?e.jsxs(e.Fragment,{children:[e.jsx(C,{title:n(t)+" | SayBerry Games News",description:t[`excerpt_${a}`]||u(t).substring(0,150)}),e.jsx("div",{className:"min-h-screen py-20 px-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs(m,{to:"/news",className:"inline-flex items-center text-gray-400 hover:text-white transition-colors",children:[e.jsx(D,{className:"h-5 w-5 mr-1"}),l.backToList]}),(j||w==="lead")&&e.jsxs("button",{onClick:()=>x(`/edit/${t.id}?type=news`),className:"flex items-center gap-2 px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-md transition-colors",children:[e.jsx(P,{className:"h-4 w-4"}),a==="ko"?"수정":a==="ja"?"編集":"Edit"]})]}),e.jsxs("article",{children:[t.featured_image&&e.jsx("div",{className:"aspect-video mb-8 overflow-hidden rounded-lg",children:e.jsx("img",{src:t.featured_image,alt:n(t),className:"w-full h-full object-cover"})}),e.jsxs("header",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("span",{className:"bg-gray-800 px-3 py-1 rounded-full text-sm",children:t.category}),e.jsxs("time",{className:"text-gray-400 text-sm flex items-center",children:[e.jsx(I,{className:"h-4 w-4 mr-1"}),g(t.date)]})]}),e.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-4",children:n(t)}),e.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-400",children:[t.author&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(q,{className:"h-4 w-4 mr-1"}),t.author]}),t.views!==void 0&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(U,{className:"h-4 w-4 mr-1"}),t.views]})]})]}),e.jsx("div",{className:"prose prose-invert prose-lg max-w-none",children:e.jsx(T,{content:u(t)})}),t.tags&&t.tags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-2 mt-8 pt-8 border-t border-gray-800",children:[e.jsx($,{className:"h-5 w-5 text-gray-400"}),t.tags.map((s,r)=>e.jsx("span",{className:"bg-gray-800 text-gray-300 px-3 py-1 rounded-full text-sm",children:s},r))]})]}),h.length>0&&e.jsxs("section",{className:"mt-16 pt-16 border-t border-gray-800",children:[e.jsx("h2",{className:"text-2xl font-bold mb-8",children:l.relatedNews}),e.jsx("div",{className:"grid gap-6",children:h.map(s=>e.jsx(m,{to:`/news/${s.slug}`,className:"block bg-gray-900 rounded-lg p-6 hover:bg-gray-800 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-semibold mb-2 line-clamp-2",children:n(s)}),e.jsx("p",{className:"text-gray-400 text-sm",children:g(s.date)})]}),s.featured_image&&e.jsx("img",{src:s.featured_image,alt:n(s),className:"w-24 h-24 object-cover rounded ml-4"})]})},s.id))})]})]})})]}):e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl mb-4",children:"News not found"}),e.jsx(m,{to:"/news",className:"text-blue-500 hover:text-blue-400",children:l.backToList})]})})};export{H as default};
