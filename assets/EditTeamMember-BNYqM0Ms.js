import{d as L,h as O,a as T,u as z,b as M,r as c,s as u,j as e,U,X as F}from"./index-CmfddaQi.js";import{S as $}from"./SEO-DYQLxDBQ.js";import{A as E}from"./alert-circle-o5k9RG1w.js";import{P as B}from"./plus-aLHcDu9z.js";import{T as G}from"./trash-2-cdmhsEf_.js";import{S as X}from"./save-CVFXo7k7.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=L("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),se=()=>{var k;const{id:d}=O(),{isAdmin:h}=T(),{language:x}=z(),j=M(),[C,P]=c.useState(null),[o,y]=c.useState({}),[A,S]=c.useState([]),[i,g]=c.useState([]),[D,I]=c.useState(!0),[N,_]=c.useState(!1),[w,f]=c.useState(""),s={ko:{title:"팀원 수정",name:"이름",role:"역할",description:"소개",profileImage:"프로필 이미지",sortOrder:"정렬 순서",active:"활성",save:"저장",cancel:"취소",saveError:"저장 중 오류가 발생했습니다.",loadError:"팀원 정보를 불러오는 중 오류가 발생했습니다.",unauthorized:"관리자 권한이 필요합니다.",roleKo:"한국어 역할",roleEn:"영어 역할",roleJa:"일본어 역할",descriptionKo:"한국어 소개",descriptionEn:"영어 소개",descriptionJa:"일본어 소개",projectAssignments:"프로젝트 할당",project:"프로젝트",projectRole:"역할",isLead:"리드",addProject:"프로젝트 추가",removeProject:"제거"},en:{title:"Edit Team Member",name:"Name",role:"Role",description:"Description",profileImage:"Profile Image",sortOrder:"Sort Order",active:"Active",save:"Save",cancel:"Cancel",saveError:"Error saving changes.",loadError:"Error loading team member.",unauthorized:"Admin access required.",roleKo:"Korean Role",roleEn:"English Role",roleJa:"Japanese Role",descriptionKo:"Korean Description",descriptionEn:"English Description",descriptionJa:"Japanese Description",projectAssignments:"Project Assignments",project:"Project",projectRole:"Role",isLead:"Lead",addProject:"Add Project",removeProject:"Remove"},ja:{title:"チームメンバー編集",name:"名前",role:"役割",description:"紹介",profileImage:"プロフィール画像",sortOrder:"ソート順",active:"アクティブ",save:"保存",cancel:"キャンセル",saveError:"保存中にエラーが発生しました。",loadError:"チームメンバーの読み込み中にエラーが発生しました。",unauthorized:"管理者権限が必要です。",roleKo:"韓国語役割",roleEn:"英語役割",roleJa:"日本語役割",descriptionKo:"韓国語紹介",descriptionEn:"英語紹介",descriptionJa:"日本語紹介",projectAssignments:"プロジェクト割り当て",project:"プロジェクト",projectRole:"役割",isLead:"リード",addProject:"プロジェクト追加",removeProject:"削除"}}[x];c.useEffect(()=>{if(!h){j("/team");return}d&&J()},[h,d]);const J=async()=>{try{const{data:r,error:a}=await u.from("team_members").select("*").eq("id",d).single();if(a)throw a;const{data:t,error:n}=await u.from("projects").select("*").order("name_ko");if(n)throw n;const{data:v,error:m}=await u.from("team_member_projects").select("*").eq("team_member_id",d);if(m)throw m;P(r),y(r),S(t||[]),g(v||[])}catch(r){console.error("Error fetching data:",r),f(s.loadError)}finally{I(!1)}},K=async r=>{r.preventDefault(),_(!0),f("");try{const a={...o};delete a.id,delete a.created_at,delete a.updated_at,console.log("Updating team member with data:",a);const{data:t,error:n}=await u.from("team_members").update(a).eq("id",d).select();if(n)throw console.error("Supabase update error:",n),n;if(await u.from("team_member_projects").delete().eq("team_member_id",d),i.length>0){const v=i.map(b=>({team_member_id:d,project_id:b.project_id,role_ko:b.role_ko,role_en:b.role_en,role_ja:b.role_ja,is_lead:b.is_lead})),{error:m}=await u.from("team_member_projects").insert(v);if(m)throw console.error("Error updating project assignments:",m),m}console.log("Update successful:",t),j("/team")}catch(a){console.error("Error updating team member:",a),f(`${s.saveError} ${a.message||""}`)}finally{_(!1)}},l=(r,a)=>{y(t=>({...t,[r]:a}))},p=(r,a,t)=>{const n=[...i];n[r]={...n[r],[a]:t},g(n)},R=()=>{g([...i,{project_id:"",role_ko:"",role_en:"",role_ja:"",is_lead:!1}])},q=r=>{g(i.filter((a,t)=>t!==r))};return D?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"})}):h?C?e.jsxs(e.Fragment,{children:[e.jsx($,{title:s.title+" | SayBerry Games"}),e.jsx("div",{className:"min-h-screen py-20 px-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("h1",{className:"text-4xl font-bold mb-8",children:s.title}),e.jsxs("form",{onSubmit:K,className:"space-y-8",children:[e.jsx("div",{className:"bg-gray-900 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("div",{children:o.avatar_url?e.jsx("img",{src:o.avatar_url,alt:"Profile",className:"w-24 h-24 rounded-full object-cover"}):e.jsx("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-2xl font-bold",children:((k=o.name)==null?void 0:k.charAt(0))||"A"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:[e.jsx(H,{className:"inline h-4 w-4 mr-2"}),s.profileImage]}),e.jsx("input",{type:"url",value:o.avatar_url||"",onChange:r=>l("avatar_url",r.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-md focus:border-blue-500 focus:outline-none",placeholder:"https://example.com/image.jpg"})]})]})}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:s.name}),e.jsx("div",{children:e.jsx("input",{type:"text",value:o.name||"",onChange:r=>l("name",r.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-md focus:border-blue-500 focus:outline-none",placeholder:"베리",required:!0})})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:s.role}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:s.roleKo}),e.jsx("input",{type:"text",value:o.role_ko||"",onChange:r=>l("role_ko",r.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-md focus:border-blue-500 focus:outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:s.roleEn}),e.jsx("input",{type:"text",value:o.role_en||"",onChange:r=>l("role_en",r.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-md focus:border-blue-500 focus:outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:s.roleJa}),e.jsx("input",{type:"text",value:o.role_ja||"",onChange:r=>l("role_ja",r.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-md focus:border-blue-500 focus:outline-none",required:!0})]})]})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:s.description}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:s.descriptionKo}),e.jsx("textarea",{value:o.description_ko||"",onChange:r=>l("description_ko",r.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-md focus:border-blue-500 focus:outline-none",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:s.descriptionEn}),e.jsx("textarea",{value:o.description_en||"",onChange:r=>l("description_en",r.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-md focus:border-blue-500 focus:outline-none",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:s.descriptionJa}),e.jsx("textarea",{value:o.description_ja||"",onChange:r=>l("description_ja",r.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-md focus:border-blue-500 focus:outline-none",rows:3})]})]})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold",children:s.projectAssignments}),e.jsxs("button",{type:"button",onClick:R,className:"flex items-center gap-2 px-3 py-1 bg-blue-600 hover:bg-blue-700 rounded text-sm",children:[e.jsx(B,{className:"h-4 w-4"}),s.addProject]})]}),e.jsxs("div",{className:"space-y-4",children:[i.map((r,a)=>e.jsxs("div",{className:"border border-gray-700 rounded p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("h4",{className:"text-sm font-medium",children:[s.project," #",a+1]}),e.jsx("button",{type:"button",onClick:()=>q(a),className:"text-red-400 hover:text-red-300",children:e.jsx(G,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:s.project}),e.jsxs("select",{value:r.project_id,onChange:t=>p(a,"project_id",t.target.value),className:"w-full px-3 py-1 bg-gray-800 border border-gray-700 rounded text-sm",children:[e.jsx("option",{value:"",children:"선택하세요"}),A.map(t=>e.jsx("option",{value:t.id,children:x==="ko"?t.name_ko:x==="ja"?t.name_ja:t.name_en},t.id))]})]}),e.jsx("div",{className:"flex items-end gap-3",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.is_lead,onChange:t=>p(a,"is_lead",t.target.checked),className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:s.isLead})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mt-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:s.roleKo}),e.jsx("input",{type:"text",value:r.role_ko,onChange:t=>p(a,"role_ko",t.target.value),className:"w-full px-3 py-1 bg-gray-800 border border-gray-700 rounded text-sm",placeholder:"예: 클라이언트 개발"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:s.roleEn}),e.jsx("input",{type:"text",value:r.role_en,onChange:t=>p(a,"role_en",t.target.value),className:"w-full px-3 py-1 bg-gray-800 border border-gray-700 rounded text-sm",placeholder:"e.g. Client Developer"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:s.roleJa}),e.jsx("input",{type:"text",value:r.role_ja,onChange:t=>p(a,"role_ja",t.target.value),className:"w-full px-3 py-1 bg-gray-800 border border-gray-700 rounded text-sm",placeholder:"例: クライアント開発"})]})]})]},a)),i.length===0&&e.jsx("p",{className:"text-gray-500 text-sm text-center py-4",children:x==="ko"?"프로젝트 할당이 없습니다.":x==="ja"?"プロジェクト割り当てがありません。":"No project assignments."})]})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"설정"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:s.sortOrder}),e.jsx("input",{type:"number",value:o.sort_order||0,onChange:r=>l("sort_order",parseInt(r.target.value)),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-md focus:border-blue-500 focus:outline-none"})]}),e.jsx("div",{className:"flex items-center",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:o.active!==void 0?o.active:!0,onChange:r=>l("active",r.target.checked),className:"w-4 h-4"}),e.jsx("span",{children:s.active})]})})]})]}),w&&e.jsxs("div",{className:"p-4 bg-red-900/20 border border-red-500 rounded-lg text-red-400 flex items-center gap-2",children:[e.jsx(E,{className:"h-5 w-5"}),w]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("button",{type:"submit",disabled:N,className:"flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 rounded-md transition-colors",children:[e.jsx(X,{className:"h-5 w-5"}),N?"저장 중...":s.save]}),e.jsxs("button",{type:"button",onClick:()=>j("/team"),className:"flex items-center gap-2 px-6 py-3 bg-gray-700 hover:bg-gray-600 rounded-md transition-colors",children:[e.jsx(F,{className:"h-5 w-5"}),s.cancel]})]})]})]})})]}):e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(E,{className:"h-16 w-16 text-red-500 mx-auto mb-4"}),e.jsx("p",{className:"text-xl",children:s.loadError})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(U,{className:"h-16 w-16 text-red-500 mx-auto mb-4"}),e.jsx("p",{className:"text-xl",children:s.unauthorized})]})})};export{se as default};
